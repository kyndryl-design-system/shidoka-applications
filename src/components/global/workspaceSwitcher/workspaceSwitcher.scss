@use '../../../common/scss/global.scss';
@use '@kyndryl-design-system/shidoka-foundation/scss/mixins/typography.scss';

:host {
  display: block;
}

.workspace-switcher {
  display: flex;
  position: relative;
  width: 100%;
  margin: -8px -12px;
  max-height: var(--kyn-workspace-switcher-max-height, none);
  background: var(--kd-color-background-container-default);
  border-radius: 8px;
  overflow: hidden;
}

/* Left panel — only in-flow child, drives the container height */
.workspace-switcher__left {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  width: 275px;
  flex-shrink: 0;
  padding: 12px;
  background: var(--kd-color-background-opacity-1);
  border-radius: 8px 0 0 8px;
  box-sizing: border-box;
}

/* Right panel — absolutely positioned so it doesn't affect container height;
   fills the height set by the left pane and scrolls independently */
.workspace-switcher__right {
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  left: 275px;
  padding: 12px 8px 0 12px;
  box-sizing: border-box;
  overflow-y: auto;
}

/* Back button — mobile only, reuses menu-item variant="back" */
.workspace-switcher__back {
  margin-bottom: 8px;

  @media (min-width: 52rem) {
    display: none;
  }
}

.workspace-switcher__title {
  @include typography.type-ui-03;
  font-weight: 500;
  text-transform: uppercase;
  color: var(--kd-color-text-level-primary);
  padding: 4px 8px;
  width: 100%;
  box-sizing: border-box;
}

.workspace-switcher__list {
  display: flex;
  flex-direction: column;
  gap: 2px;
  width: 100%;
}

/* Left-slot separator — universal header/list divider */
::slotted([slot='left']) {
  width: 100%;
  padding-left: 8px;
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom: 1px solid var(--kd-color-border-variants-light);
  box-sizing: border-box;
}

/* Ensure slotted content fills available space */
::slotted([slot='left-list']),
::slotted([slot='right']),
::slotted([slot='right-list']) {
  width: 100%;
}

/* ===== Mobile drill-down ===== */
@media (max-width: calc(52rem - 0.001px)) {
  :host {
    width: 100%;
    height: var(--kyn-workspace-switcher-max-height, 100%);
    overflow: hidden;
  }

  .workspace-switcher {
    display: block;
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  .workspace-switcher__left,
  .workspace-switcher__right {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    transition: transform 200ms ease-out;
    box-sizing: border-box;
  }

  .workspace-switcher__left {
    border-radius: 0;
    padding: 12px;
    overflow-y: auto;
  }

  .workspace-switcher__right {
    padding: 12px;
  }

  /* Root view: left visible, right off-screen right */
  :host(:not([view='detail'])) {
    .workspace-switcher__left {
      transform: translateX(0);
    }

    .workspace-switcher__right {
      transform: translateX(100%);
    }
  }

  /* Detail view: left off-screen left, right visible */
  :host([view='detail']) {
    .workspace-switcher__left {
      transform: translateX(-100%);
    }

    .workspace-switcher__right {
      transform: translateX(0);
    }
  }

  @media (max-width: calc(42rem - 0.001px)) {
    .workspace-switcher {
      margin-top: 4px;
    }
  }
}
